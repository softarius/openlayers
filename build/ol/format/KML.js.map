{"version":3,"file":"KML.js","sources":["../../../src/ol/format/KML.js"],"sourcesContent":["/**\r\n * @module ol/format/KML\r\n */\r\nimport Feature from '../Feature.js';\r\nimport { extend, includes } from '../array.js';\r\nimport { assert } from '../asserts.js';\r\nimport { asArray } from '../color.js';\r\nimport { transformWithOptions } from './Feature.js';\r\nimport XMLFeature from './XMLFeature.js';\r\nimport { readDecimal, readBoolean, readString, writeStringTextNode, writeCDATASection, writeDecimalTextNode, writeBooleanTextNode } from './xsd.js';\r\nimport GeometryCollection from '../geom/GeometryCollection.js';\r\nimport GeometryLayout from '../geom/GeometryLayout.js';\r\nimport GeometryType from '../geom/GeometryType.js';\r\nimport LineString from '../geom/LineString.js';\r\nimport MultiLineString from '../geom/MultiLineString.js';\r\nimport MultiPoint from '../geom/MultiPoint.js';\r\nimport MultiPolygon from '../geom/MultiPolygon.js';\r\nimport Point from '../geom/Point.js';\r\nimport Polygon from '../geom/Polygon.js';\r\nimport { toRadians } from '../math.js';\r\nimport { get as getProjection } from '../proj.js';\r\nimport Fill from '../style/Fill.js';\r\nimport Icon from '../style/Icon.js';\r\nimport IconAnchorUnits from '../style/IconAnchorUnits.js';\r\nimport IconOrigin from '../style/IconOrigin.js';\r\nimport Stroke from '../style/Stroke.js';\r\nimport Style from '../style/Style.js';\r\nimport Text from '../style/Text.js';\r\nimport {\r\n  createElementNS, getAllTextContent, isDocument, makeArrayExtender,\r\n  makeArrayPusher, makeChildAppender, makeObjectPropertySetter,\r\n  makeReplacer, makeSequence, makeSimpleNodeFactory, makeStructureNS,\r\n  OBJECT_PROPERTY_NODE_FACTORY, parse, parseNode, pushParseAndPop,\r\n  pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI\r\n} from '../xml.js';\r\n\r\n/**\r\n * @typedef {Object} Vec2\r\n * @property {number} x\r\n * @property {IconAnchorUnits} xunits\r\n * @property {number} y\r\n * @property {IconAnchorUnits} yunits\r\n * @property {IconOrigin} origin\r\n */\r\n\r\n/**\r\n * @typedef {Object} GxTrackObject\r\n * @property {Array<number>} flatCoordinates\r\n * @property {Array<number>} whens\r\n */\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Array<string>}\r\n */\r\nconst GX_NAMESPACE_URIS = [\r\n  'http://www.google.com/kml/ext/2.2'\r\n];\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Array<null|string>}\r\n */\r\nconst NAMESPACE_URIS = [\r\n  null,\r\n  'http://earth.google.com/kml/2.0',\r\n  'http://earth.google.com/kml/2.1',\r\n  'http://earth.google.com/kml/2.2',\r\n  'http://www.opengis.net/kml/2.2',\r\n  'http://www.openlayers.org'\r\n];\r\n\r\n\r\n/**\r\n * @const\r\n * @type {string}\r\n */\r\nconst SCHEMA_LOCATION = 'http://www.opengis.net/kml/2.2 ' +\r\n  'https://developers.google.com/kml/schema/kml22gx.xsd';\r\n\r\n\r\n/**\r\n * @type {Object<string, IconAnchorUnits>}\r\n */\r\nconst ICON_ANCHOR_UNITS_MAP = {\r\n  'fraction': IconAnchorUnits.FRACTION,\r\n  'pixels': IconAnchorUnits.PIXELS,\r\n  'insetPixels': IconAnchorUnits.PIXELS\r\n};\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst PLACEMARK_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'ExtendedData': extendedDataParser,\r\n    'Region': regionParser,\r\n    'MultiGeometry': makeObjectPropertySetter(\r\n      readMultiGeometry, 'geometry'),\r\n    'LineString': makeObjectPropertySetter(\r\n      readLineString, 'geometry'),\r\n    'LinearRing': makeObjectPropertySetter(\r\n      readLinearRing, 'geometry'),\r\n    'Point': makeObjectPropertySetter(\r\n      readPoint, 'geometry'),\r\n    'Polygon': makeObjectPropertySetter(\r\n      readPolygon, 'geometry'),\r\n    'Style': makeObjectPropertySetter(readStyle),\r\n    'StyleMap': placemarkStyleMapParser,\r\n    'address': makeObjectPropertySetter(readString),\r\n    'description': makeObjectPropertySetter(readString),\r\n    'name': makeObjectPropertySetter(readString),\r\n    'open': makeObjectPropertySetter(readBoolean),\r\n    'phoneNumber': makeObjectPropertySetter(readString),\r\n    'styleUrl': makeObjectPropertySetter(readURI),\r\n    'visibility': makeObjectPropertySetter(readBoolean)\r\n  }, makeStructureNS(\r\n    GX_NAMESPACE_URIS, {\r\n      'MultiTrack': makeObjectPropertySetter(\r\n        readGxMultiTrack, 'geometry'),\r\n      'Track': makeObjectPropertySetter(\r\n        readGxTrack, 'geometry')\r\n    }\r\n  ));\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst NETWORK_LINK_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'ExtendedData': extendedDataParser,\r\n    'Region': regionParser,\r\n    'Link': linkParser,\r\n    'address': makeObjectPropertySetter(readString),\r\n    'description': makeObjectPropertySetter(readString),\r\n    'name': makeObjectPropertySetter(readString),\r\n    'open': makeObjectPropertySetter(readBoolean),\r\n    'phoneNumber': makeObjectPropertySetter(readString),\r\n    'visibility': makeObjectPropertySetter(readBoolean)\r\n  });\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst LINK_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'href': makeObjectPropertySetter(readURI)\r\n  });\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst REGION_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'LatLonAltBox': latLonAltBoxParser,\r\n    'Lod': lodParser\r\n  });\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst KML_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'Document', 'Placemark'\r\n  ]);\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst KML_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Document': makeChildAppender(writeDocument),\r\n    'Placemark': makeChildAppender(writePlacemark)\r\n  });\r\n\r\n\r\n/**\r\n * @type {import(\"../color.js\").Color}\r\n */\r\nlet DEFAULT_COLOR;\r\n\r\n/**\r\n * @type {Fill}\r\n */\r\nlet DEFAULT_FILL_STYLE = null;\r\n\r\n/**\r\n * Get the default fill style (or null if not yet set).\r\n * @return {Fill} The default fill style.\r\n */\r\nexport function getDefaultFillStyle() {\r\n  return DEFAULT_FILL_STYLE;\r\n}\r\n\r\n/**\r\n * @type {import(\"../size.js\").Size}\r\n */\r\nlet DEFAULT_IMAGE_STYLE_ANCHOR;\r\n\r\n/**\r\n * @type {IconAnchorUnits}\r\n */\r\nlet DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\r\n\r\n/**\r\n * @type {IconAnchorUnits}\r\n */\r\nlet DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\r\n\r\n/**\r\n * @type {import(\"../size.js\").Size}\r\n */\r\nlet DEFAULT_IMAGE_STYLE_SIZE;\r\n\r\n/**\r\n * @type {string}\r\n */\r\nlet DEFAULT_IMAGE_STYLE_SRC;\r\n\r\n/**\r\n * @type {number}\r\n */\r\nlet DEFAULT_IMAGE_SCALE_MULTIPLIER;\r\n\r\n/**\r\n * @type {import(\"../style/Image.js\").default}\r\n */\r\nlet DEFAULT_IMAGE_STYLE = null;\r\n\r\n/**\r\n * Get the default image style (or null if not yet set).\r\n * @return {import(\"../style/Image.js\").default} The default image style.\r\n */\r\nexport function getDefaultImageStyle() {\r\n  return DEFAULT_IMAGE_STYLE;\r\n}\r\n\r\n/**\r\n * @type {string}\r\n */\r\nlet DEFAULT_NO_IMAGE_STYLE;\r\n\r\n/**\r\n * @type {Stroke}\r\n */\r\nlet DEFAULT_STROKE_STYLE = null;\r\n\r\n/**\r\n * Get the default stroke style (or null if not yet set).\r\n * @return {Stroke} The default stroke style.\r\n */\r\nexport function getDefaultStrokeStyle() {\r\n  return DEFAULT_STROKE_STYLE;\r\n}\r\n\r\n/**\r\n * @type {Stroke}\r\n */\r\nlet DEFAULT_TEXT_STROKE_STYLE;\r\n\r\n/**\r\n * @type {Text}\r\n */\r\nlet DEFAULT_TEXT_STYLE = null;\r\n\r\n/**\r\n * Get the default text style (or null if not yet set).\r\n * @return {Text} The default text style.\r\n */\r\nexport function getDefaultTextStyle() {\r\n  return DEFAULT_TEXT_STYLE;\r\n}\r\n\r\n/**\r\n * @type {Style}\r\n */\r\nlet DEFAULT_STYLE = null;\r\n\r\n/**\r\n * Get the default style (or null if not yet set).\r\n * @return {Style} The default style.\r\n */\r\nexport function getDefaultStyle() {\r\n  return DEFAULT_STYLE;\r\n}\r\n\r\n/**\r\n * @type {Array<Style>}\r\n */\r\nlet DEFAULT_STYLE_ARRAY = null;\r\n\r\n/**\r\n * Get the default style array (or null if not yet set).\r\n * @return {Array<Style>} The default style.\r\n */\r\nexport function getDefaultStyleArray() {\r\n  return DEFAULT_STYLE_ARRAY;\r\n}\r\n\r\n\r\nfunction createStyleDefaults() {\r\n\r\n  DEFAULT_COLOR = [255, 255, 255, 1];\r\n\r\n  DEFAULT_FILL_STYLE = new Fill({\r\n    color: DEFAULT_COLOR\r\n  });\r\n\r\n  DEFAULT_IMAGE_STYLE_ANCHOR = [20, 2]; // FIXME maybe [8, 32] ?\r\n\r\n  DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS = IconAnchorUnits.PIXELS;\r\n\r\n  DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS = IconAnchorUnits.PIXELS;\r\n\r\n  DEFAULT_IMAGE_STYLE_SIZE = [64, 64];\r\n\r\n  DEFAULT_IMAGE_STYLE_SRC =\r\n    'https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png';\r\n\r\n  DEFAULT_IMAGE_SCALE_MULTIPLIER = 0.5;\r\n\r\n  DEFAULT_IMAGE_STYLE = new Icon({\r\n    anchor: DEFAULT_IMAGE_STYLE_ANCHOR,\r\n    anchorOrigin: IconOrigin.BOTTOM_LEFT,\r\n    anchorXUnits: DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,\r\n    anchorYUnits: DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,\r\n    crossOrigin: 'anonymous',\r\n    rotation: 0,\r\n    scale: DEFAULT_IMAGE_SCALE_MULTIPLIER,\r\n    size: DEFAULT_IMAGE_STYLE_SIZE,\r\n    src: DEFAULT_IMAGE_STYLE_SRC\r\n  });\r\n\r\n  DEFAULT_NO_IMAGE_STYLE = 'NO_IMAGE';\r\n\r\n  DEFAULT_STROKE_STYLE = new Stroke({\r\n    color: DEFAULT_COLOR,\r\n    width: 1\r\n  });\r\n\r\n  DEFAULT_TEXT_STROKE_STYLE = new Stroke({\r\n    color: [51, 51, 51, 1],\r\n    width: 2\r\n  });\r\n\r\n  DEFAULT_TEXT_STYLE = new Text({\r\n    font: 'bold 16px Helvetica',\r\n    fill: DEFAULT_FILL_STYLE,\r\n    stroke: DEFAULT_TEXT_STROKE_STYLE,\r\n    scale: 0.8\r\n  });\r\n\r\n  DEFAULT_STYLE = new Style({\r\n    fill: DEFAULT_FILL_STYLE,\r\n    image: DEFAULT_IMAGE_STYLE,\r\n    text: DEFAULT_TEXT_STYLE,\r\n    stroke: DEFAULT_STROKE_STYLE,\r\n    zIndex: 0\r\n  });\r\n\r\n  DEFAULT_STYLE_ARRAY = [DEFAULT_STYLE];\r\n\r\n}\r\n\r\n\r\n/**\r\n * @typedef {Object} Options\r\n * @property {boolean} [extractStyles=true] Extract styles from the KML.\r\n * @property {boolean} [showPointNames=true] Show names as labels for placemarks which contain points.\r\n * @property {Array<Style>} [defaultStyle] Default style. The\r\n * default default style is the same as Google Earth.\r\n * @property {boolean} [writeStyles=true] Write styles into KML.\r\n */\r\n\r\n\r\n/**\r\n * @classdesc\r\n * Feature format for reading and writing data in the KML format.\r\n *\r\n * {@link module:ol/format/KML~KML#readFeature} will read the first feature from\r\n * a KML source.\r\n *\r\n * MultiGeometries are converted into GeometryCollections if they are a mix of\r\n * geometry types, and into MultiPoint/MultiLineString/MultiPolygon if they are\r\n * all of the same type.\r\n *\r\n * Note that the KML format uses the URL() constructor. Older browsers such as IE\r\n * which do not support this will need a URL polyfill to be loaded before use.\r\n *\r\n * @api\r\n */\r\nclass KML extends XMLFeature {\r\n\r\n  /**\r\n   * @param {Options=} opt_options Options.\r\n   */\r\n  constructor(opt_options) {\r\n    super();\r\n\r\n    const options = opt_options ? opt_options : {};\r\n\r\n    if (!DEFAULT_STYLE_ARRAY) {\r\n      createStyleDefaults();\r\n    }\r\n\r\n    /**\r\n     * @inheritDoc\r\n     */\r\n    this.dataProjection = getProjection('EPSG:4326');\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array<Style>}\r\n     */\r\n    this.defaultStyle_ = options.defaultStyle ?\r\n      options.defaultStyle : DEFAULT_STYLE_ARRAY;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.extractStyles_ = options.extractStyles !== undefined ?\r\n      options.extractStyles : true;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.writeStyles_ = options.writeStyles !== undefined ?\r\n      options.writeStyles : true;\r\n\r\n    /**\r\n     * @private\r\n     * @type {!Object<string, (Array<Style>|string)>}\r\n     */\r\n    this.sharedStyles_ = {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.showPointNames_ = options.showPointNames !== undefined ?\r\n      options.showPointNames : true;\r\n\r\n  }\r\n\r\n  /**\r\n   * @param {Node} node Node.\r\n   * @param {Array<*>} objectStack Object stack.\r\n   * @private\r\n   * @return {Array<Feature>|undefined} Features.\r\n   */\r\n  readDocumentOrFolder_(node, objectStack) {\r\n    // FIXME use scope somehow\r\n    const parsersNS = makeStructureNS(\r\n      NAMESPACE_URIS, {\r\n        'Document': makeArrayExtender(this.readDocumentOrFolder_, this),\r\n        'Folder': makeArrayExtender(this.readDocumentOrFolder_, this),\r\n        'Placemark': makeArrayPusher(this.readPlacemark_, this),\r\n        'Style': this.readSharedStyle_.bind(this),\r\n        'StyleMap': this.readSharedStyleMap_.bind(this)\r\n      });\r\n    /** @type {Array<Feature>} */\r\n    const features = pushParseAndPop([], parsersNS, node, objectStack, this);\r\n    if (features) {\r\n      return features;\r\n    } else {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {Element} node Node.\r\n   * @param {Array<*>} objectStack Object stack.\r\n   * @private\r\n   * @return {Feature|undefined} Feature.\r\n   */\r\n  readPlacemark_(node, objectStack) {\r\n    const object = pushParseAndPop({ 'geometry': null },\r\n      PLACEMARK_PARSERS, node, objectStack);\r\n    if (!object) {\r\n      return undefined;\r\n    }\r\n    const feature = new Feature();\r\n    const id = node.getAttribute('id');\r\n    if (id !== null) {\r\n      feature.setId(id);\r\n    }\r\n    const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (objectStack[0]);\r\n\r\n    const geometry = object['geometry'];\r\n    if (geometry) {\r\n      transformWithOptions(geometry, false, options);\r\n    }\r\n    feature.setGeometry(geometry);\r\n    delete object['geometry'];\r\n\r\n    if (this.extractStyles_) {\r\n      const style = object['Style'];\r\n\r\n      const styleUrl = object['styleUrl'];\r\n      const styleFunction = createFeatureStyleFunction(\r\n        style, styleUrl, this.defaultStyle_, this.sharedStyles_,\r\n        this.showPointNames_);\r\n      feature.setStyle(styleFunction);\r\n    }\r\n\r\n    delete object['Style'];\r\n    // we do not remove the styleUrl property from the object, so it\r\n    // gets stored on feature when setProperties is called\r\n\r\n    feature.setProperties(object);\r\n\r\n    return feature;\r\n  }\r\n\r\n  /**\r\n   * @param {Element} node Node.\r\n   * @param {Array<*>} objectStack Object stack.\r\n   * @private\r\n   */\r\n  readSharedStyle_(node, objectStack) {\r\n    const id = node.getAttribute('id');\r\n    if (id !== null) {\r\n      const style = readStyle(node, objectStack);\r\n      if (style) {\r\n        let styleUri;\r\n        let baseURI = node.baseURI;\r\n        if (!baseURI || baseURI == 'about:blank') {\r\n          baseURI = window.location.href;\r\n        }\r\n        if (baseURI) {\r\n          const url = new URL('#' + id, baseURI);\r\n          styleUri = url.href;\r\n        } else {\r\n          styleUri = '#' + id;\r\n        }\r\n        this.sharedStyles_[styleUri] = style;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {Element} node Node.\r\n   * @param {Array<*>} objectStack Object stack.\r\n   * @private\r\n   */\r\n  readSharedStyleMap_(node, objectStack) {\r\n    const id = node.getAttribute('id');\r\n    if (id === null) {\r\n      return;\r\n    }\r\n    const styleMapValue = readStyleMapValue(node, objectStack);\r\n    if (!styleMapValue) {\r\n      return;\r\n    }\r\n    let styleUri;\r\n    let baseURI = node.baseURI;\r\n    if (!baseURI || baseURI == 'about:blank') {\r\n      baseURI = window.location.href;\r\n    }\r\n    if (baseURI) {\r\n      const url = new URL('#' + id, baseURI);\r\n      styleUri = url.href;\r\n    } else {\r\n      styleUri = '#' + id;\r\n    }\r\n    this.sharedStyles_[styleUri] = styleMapValue;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  readFeatureFromNode(node, opt_options) {\r\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\r\n      return null;\r\n    }\r\n    const feature = this.readPlacemark_(\r\n      node, [this.getReadOptions(node, opt_options)]);\r\n    if (feature) {\r\n      return feature;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  readFeaturesFromNode(node, opt_options) {\r\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\r\n      return [];\r\n    }\r\n    let features;\r\n    const localName = node.localName;\r\n    if (localName == 'Document' || localName == 'Folder') {\r\n      features = this.readDocumentOrFolder_(\r\n        node, [this.getReadOptions(node, opt_options)]);\r\n      if (features) {\r\n        return features;\r\n      } else {\r\n        return [];\r\n      }\r\n    } else if (localName == 'Placemark') {\r\n      const feature = this.readPlacemark_(\r\n        node, [this.getReadOptions(node, opt_options)]);\r\n      if (feature) {\r\n        return [feature];\r\n      } else {\r\n        return [];\r\n      }\r\n    } else if (localName == 'kml') {\r\n      features = [];\r\n      for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n        const fs = this.readFeaturesFromNode(n, opt_options);\r\n        if (fs) {\r\n          extend(features, fs);\r\n        }\r\n      }\r\n      return features;\r\n    } else {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Read the name of the KML.\r\n   *\r\n   * @param {Document|Element|string} source Source.\r\n   * @return {string|undefined} Name.\r\n   * @api\r\n   */\r\n  readName(source) {\r\n    if (!source) {\r\n      return undefined;\r\n    } else if (typeof source === 'string') {\r\n      const doc = parse(source);\r\n      return this.readNameFromDocument(doc);\r\n    } else if (isDocument(source)) {\r\n      return this.readNameFromDocument(/** @type {Document} */(source));\r\n    } else {\r\n      return this.readNameFromNode(/** @type {Element} */(source));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {Document} doc Document.\r\n   * @return {string|undefined} Name.\r\n   */\r\n  readNameFromDocument(doc) {\r\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\r\n      if (n.nodeType == Node.ELEMENT_NODE) {\r\n        const name = this.readNameFromNode(/** @type {Element} */(n));\r\n        if (name) {\r\n          return name;\r\n        }\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * @param {Element} node Node.\r\n   * @return {string|undefined} Name.\r\n   */\r\n  readNameFromNode(node) {\r\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\r\n        n.localName == 'name') {\r\n        return readString(n);\r\n      }\r\n    }\r\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n      const localName = n.localName;\r\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\r\n        (localName == 'Document' ||\r\n          localName == 'Folder' ||\r\n          localName == 'Placemark' ||\r\n          localName == 'kml')) {\r\n        const name = this.readNameFromNode(n);\r\n        if (name) {\r\n          return name;\r\n        }\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Read the network links of the KML.\r\n   *\r\n   * @param {Document|Element|string} source Source.\r\n   * @return {Array<Object>} Network links.\r\n   * @api\r\n   */\r\n  readNetworkLinks(source) {\r\n    const networkLinks = [];\r\n    if (typeof source === 'string') {\r\n      const doc = parse(source);\r\n      extend(networkLinks, this.readNetworkLinksFromDocument(doc));\r\n    } else if (isDocument(source)) {\r\n      extend(networkLinks, this.readNetworkLinksFromDocument(\r\n        /** @type {Document} */(source)));\r\n    } else {\r\n      extend(networkLinks, this.readNetworkLinksFromNode(\r\n        /** @type {Element} */(source)));\r\n    }\r\n    return networkLinks;\r\n  }\r\n\r\n  /**\r\n   * @param {Document} doc Document.\r\n   * @return {Array<Object>} Network links.\r\n   */\r\n  readNetworkLinksFromDocument(doc) {\r\n    const networkLinks = [];\r\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\r\n      if (n.nodeType == Node.ELEMENT_NODE) {\r\n        extend(networkLinks, this.readNetworkLinksFromNode(/** @type {Element} */(n)));\r\n      }\r\n    }\r\n    return networkLinks;\r\n  }\r\n\r\n  /**\r\n   * @param {Element} node Node.\r\n   * @return {Array<Object>} Network links.\r\n   */\r\n  readNetworkLinksFromNode(node) {\r\n    const networkLinks = [];\r\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\r\n        n.localName == 'NetworkLink') {\r\n        const obj = pushParseAndPop({}, NETWORK_LINK_PARSERS,\r\n          n, []);\r\n        networkLinks.push(obj);\r\n      }\r\n    }\r\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n      const localName = n.localName;\r\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\r\n        (localName == 'Document' ||\r\n          localName == 'Folder' ||\r\n          localName == 'kml')) {\r\n        extend(networkLinks, this.readNetworkLinksFromNode(n));\r\n      }\r\n    }\r\n    return networkLinks;\r\n  }\r\n\r\n  /**\r\n   * Read the regions of the KML.\r\n   *\r\n   * @param {Document|Element|string} source Source.\r\n   * @return {Array<Object>} Regions.\r\n   * @api\r\n   */\r\n  readRegion(source) {\r\n    const regions = [];\r\n    if (typeof source === 'string') {\r\n      const doc = parse(source);\r\n      extend(regions, this.readRegionFromDocument(doc));\r\n    } else if (isDocument(source)) {\r\n      extend(regions, this.readRegionFromDocument(\r\n        /** @type {Document} */(source)));\r\n    } else {\r\n      extend(regions, this.readRegionFromNode(\r\n        /** @type {Element} */(source)));\r\n    }\r\n    return regions;\r\n  }\r\n\r\n  /**\r\n   * @param {Document} doc Document.\r\n   * @return {Array<Object>} Region.\r\n   */\r\n  readRegionFromDocument(doc) {\r\n    const regions = [];\r\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\r\n      if (n.nodeType == Node.ELEMENT_NODE) {\r\n        extend(regions, this.readRegionFromNode(/** @type {Element} */(n)));\r\n      }\r\n    }\r\n    return regions;\r\n  }\r\n\r\n  /**\r\n   * @param {Element} node Node.\r\n   * @return {Array<Object>} Region.\r\n   * @api\r\n   */\r\n  readRegionFromNode(node) {\r\n    const regions = [];\r\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\r\n        n.localName == 'Region') {\r\n        const obj = pushParseAndPop({}, REGION_PARSERS,\r\n          n, []);\r\n        regions.push(obj);\r\n      }\r\n    }\r\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\r\n      const localName = n.localName;\r\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\r\n        (localName == 'Document' ||\r\n          localName == 'Folder' ||\r\n          localName == 'kml')) {\r\n        extend(regions, this.readRegionFromNode(n));\r\n      }\r\n    }\r\n    return regions;\r\n  }\r\n\r\n  /**\r\n   * Encode an array of features in the KML format as an XML node. GeometryCollections,\r\n   * MultiPoints, MultiLineStrings, and MultiPolygons are output as MultiGeometries.\r\n   *\r\n   * @param {Array<Feature>} features Features.\r\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\r\n   * @return {Node} Node.\r\n   * @override\r\n   * @api\r\n   */\r\n  writeFeaturesNode(features, opt_options) {\r\n    opt_options = this.adaptOptions(opt_options);\r\n    const kml = createElementNS(NAMESPACE_URIS[4], 'kml');\r\n    const xmlnsUri = 'http://www.w3.org/2000/xmlns/';\r\n    kml.setAttributeNS(xmlnsUri, 'xmlns:gx', GX_NAMESPACE_URIS[0]);\r\n    kml.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\r\n    kml.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\r\n\r\n    const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: kml };\r\n    /** @type {!Object<string, (Array<Feature>|Feature|undefined)>} */\r\n    const properties = {};\r\n    if (features.length > 1) {\r\n      properties['Document'] = features;\r\n    } else if (features.length == 1) {\r\n      properties['Placemark'] = features[0];\r\n    }\r\n    const orderedKeys = KML_SEQUENCE[kml.namespaceURI];\r\n    const values = makeSequence(properties, orderedKeys);\r\n    pushSerializeAndPop(context, KML_SERIALIZERS,\r\n      OBJECT_PROPERTY_NODE_FACTORY, values, [opt_options], orderedKeys,\r\n      this);\r\n    return kml;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Style|undefined} foundStyle Style.\r\n * @param {string} name Name.\r\n * @return {Style} style Style.\r\n */\r\nfunction createNameStyleFunction(foundStyle, name) {\r\n  let textStyle = null;\r\n  const textOffset = [0, 0];\r\n  let textAlign = 'start';\r\n  if (foundStyle.getImage()) {\r\n    let imageSize = foundStyle.getImage().getImageSize();\r\n    if (imageSize === null) {\r\n      imageSize = DEFAULT_IMAGE_STYLE_SIZE;\r\n    }\r\n    if (imageSize.length == 2) {\r\n      const imageScale = foundStyle.getImage().getScale();\r\n      // Offset the label to be centered to the right of the icon, if there is\r\n      // one.\r\n      textOffset[0] = imageScale * imageSize[0] / 2;\r\n      textOffset[1] = -imageScale * imageSize[1] / 2;\r\n      textAlign = 'left';\r\n    }\r\n  }\r\n  if (foundStyle.getText() !== null) {\r\n    // clone the text style, customizing it with name, alignments and offset.\r\n    // Note that kml does not support many text options that OpenLayers does (rotation, textBaseline).\r\n    const foundText = foundStyle.getText();\r\n    textStyle = foundText.clone();\r\n    textStyle.setFont(foundText.getFont() || DEFAULT_TEXT_STYLE.getFont());\r\n    textStyle.setScale(foundText.getScale() || DEFAULT_TEXT_STYLE.getScale());\r\n    textStyle.setFill(foundText.getFill() || DEFAULT_TEXT_STYLE.getFill());\r\n    textStyle.setStroke(foundText.getStroke() || DEFAULT_TEXT_STROKE_STYLE);\r\n  } else {\r\n    textStyle = DEFAULT_TEXT_STYLE.clone();\r\n  }\r\n  textStyle.setText(name);\r\n  textStyle.setOffsetX(textOffset[0]);\r\n  textStyle.setOffsetY(textOffset[1]);\r\n  textStyle.setTextAlign(textAlign);\r\n\r\n  const nameStyle = new Style({\r\n    text: textStyle\r\n  });\r\n  return nameStyle;\r\n}\r\n\r\n\r\n/**\r\n * @param {Array<Style>|undefined} style Style.\r\n * @param {string} styleUrl Style URL.\r\n * @param {Array<Style>} defaultStyle Default style.\r\n * @param {!Object<string, (Array<Style>|string)>} sharedStyles Shared styles.\r\n * @param {boolean|undefined} showPointNames true to show names for point placemarks.\r\n * @return {import(\"../style/Style.js\").StyleFunction} Feature style function.\r\n */\r\nfunction createFeatureStyleFunction(style, styleUrl, defaultStyle, sharedStyles, showPointNames) {\r\n\r\n\r\n  return (\r\n    /**\r\n     * @param {Feature} feature feature.\r\n     * @param {number} resolution Resolution.\r\n     * @return {Array<Style>} Style.\r\n     */\r\n    function (feature, resolution) {\r\n\r\n      let drawName = showPointNames;\r\n      /** @type {Style|undefined} */\r\n      let nameStyle;\r\n      let name = '';\r\n      if (drawName) {\r\n        const geometry = feature.getGeometry();\r\n        if (geometry) {\r\n          drawName = geometry.getType() === GeometryType.POINT;\r\n        }\r\n      }\r\n\r\n      if (drawName) {\r\n        name = /** @type {string} */ (feature.get('name'));\r\n        drawName = drawName && !!name;\r\n      }\r\n\r\n      if (style) {\r\n        if (drawName) {\r\n          nameStyle = createNameStyleFunction(style[0], name);\r\n          return style.concat(nameStyle);\r\n        }\r\n\r\n        var geometry = feature.getGeometry();\r\n        if (geometry.getType() == 'Polygon' && style[0].getImage().getSrc() != DEFAULT_IMAGE_STYLE_SRC\r\n\r\n        ) {\r\n          let coordinates = geometry.getCoordinates();\r\n          geometry = new LineString(coordinates[0]);\r\n        }\r\n\r\n\r\n        if (geometry.getType() == 'LineString') {\r\n\r\n          var icon0 = style[0].getImage();\r\n          let styles = [style[0]];\r\n          var rotation = 0;\r\n          var prevdir = 777;\r\n          var i = 0;\r\n          console.log(geometry.flatCoordinates.length);\r\n          geometry.forEachSegment(function (start, end) {\r\n            if (style[0].getImage().getSrc().indexOf('rotate') != -1) { // can be rotated?\r\n              var dx = end[0] - start[0];\r\n              var dy = end[1] - start[1];\r\n              var dir = Math.PI / 2 - Math.atan2(dy, dx);\r\n\r\n              if (dir < 0) { dir = dir + Math.PI * 2 }\r\n              if (prevdir == 777) { prevdir = dir }\r\n              i++;\r\n\r\n\r\n              rotation = (dir + prevdir) / 2 + Math.PI / 2;\r\n              //if (rotation < 0) { rotation = rotation + Math.PI * 2 }\r\n              // console.log('узел ', i, dx, dy, dir, prevdir, rotation);\r\n            }\r\n\r\n            if (icon0.getSrc() != DEFAULT_IMAGE_STYLE_SRC) {\r\n              // vertex arrows etc \r\n              let rotUrl = icon0.getSrc();\r\n\r\n              styles.push(new Style({\r\n                geometry: new Point(start),\r\n                image: new Icon({\r\n                  src: rotUrl,\r\n                  anchor: [0.5, 0.5],\r\n                  rotateWithView: true,\r\n                  rotation: rotation\r\n                })\r\n              }));\r\n              // console.log(i, geometry.flatCoordinates.length / 3);\r\n              if (i + 1 == geometry.flatCoordinates.length / 3) {\r\n                styles.push(new Style({\r\n                  geometry: new Point(end),\r\n                  image: new Icon({\r\n                    src: rotUrl,\r\n                    anchor: [0.5, 0.5],\r\n                    rotateWithView: true,\r\n                    rotation: dir + Math.PI / 2\r\n                  })\r\n                }));\r\n              }\r\n\r\n            }\r\n            prevdir = dir;\r\n          }); // foreach\r\n\r\n          return styles;\r\n        }\r\n        //console.log('Возвращается стиль', style, ' типа ', typeof style);\r\n        return style;\r\n      }\r\n      if (styleUrl) {\r\n        const foundStyle = findStyle(styleUrl, defaultStyle, sharedStyles);\r\n        if (drawName) {\r\n          nameStyle = createNameStyleFunction(foundStyle[0], name);\r\n          return foundStyle.concat(nameStyle);\r\n        }\r\n        return foundStyle;\r\n      }\r\n      if (drawName) {\r\n        nameStyle = createNameStyleFunction(defaultStyle[0], name);\r\n        return defaultStyle.concat(nameStyle);\r\n      }\r\n      return defaultStyle;\r\n    }\r\n  );\r\n}\r\n\r\n\r\n/**\r\n * @param {Array<Style>|string|undefined} styleValue Style value.\r\n * @param {Array<Style>} defaultStyle Default style.\r\n * @param {!Object<string, (Array<Style>|string)>} sharedStyles\r\n * Shared styles.\r\n * @return {Array<Style>} Style.\r\n */\r\nfunction findStyle(styleValue, defaultStyle, sharedStyles) {\r\n  if (Array.isArray(styleValue)) {\r\n    return styleValue;\r\n  } else if (typeof styleValue === 'string') {\r\n    // KML files in the wild occasionally forget the leading `#` on styleUrls\r\n    // defined in the same document.  Add a leading `#` if it enables to find\r\n    // a style.\r\n    if (!(styleValue in sharedStyles) && ('#' + styleValue in sharedStyles)) {\r\n      styleValue = '#' + styleValue;\r\n    }\r\n    return findStyle(sharedStyles[styleValue], defaultStyle, sharedStyles);\r\n  } else {\r\n    return defaultStyle;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @return {import(\"../color.js\").Color|undefined} Color.\r\n */\r\nfunction readColor(node) {\r\n  const s = getAllTextContent(node, false);\r\n  // The KML specification states that colors should not include a leading `#`\r\n  // but we tolerate them.\r\n  const m = /^\\s*#?\\s*([0-9A-Fa-f]{8})\\s*$/.exec(s);\r\n  if (m) {\r\n    const hexColor = m[1];\r\n    return [\r\n      parseInt(hexColor.substr(6, 2), 16),\r\n      parseInt(hexColor.substr(4, 2), 16),\r\n      parseInt(hexColor.substr(2, 2), 16),\r\n      parseInt(hexColor.substr(0, 2), 16) / 255\r\n    ];\r\n\r\n  } else {\r\n    return undefined;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @return {Array<number>|undefined} Flat coordinates.\r\n */\r\nexport function readFlatCoordinates(node) {\r\n  let s = getAllTextContent(node, false);\r\n  const flatCoordinates = [];\r\n  // The KML specification states that coordinate tuples should not include\r\n  // spaces, but we tolerate them.\r\n  const re =\r\n    /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)(?:\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?))?\\s*/i;\r\n  let m;\r\n  while ((m = re.exec(s))) {\r\n    const x = parseFloat(m[1]);\r\n    const y = parseFloat(m[2]);\r\n    const z = m[3] ? parseFloat(m[3]) : 0;\r\n    flatCoordinates.push(x, y, z);\r\n    s = s.substr(m[0].length);\r\n  }\r\n  if (s !== '') {\r\n    return undefined;\r\n  }\r\n  return flatCoordinates;\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @return {string} URI.\r\n */\r\nfunction readURI(node) {\r\n  const s = getAllTextContent(node, false).trim();\r\n  let baseURI = node.baseURI;\r\n  if (!baseURI || baseURI == 'about:blank') {\r\n    baseURI = window.location.href;\r\n  }\r\n  if (baseURI) {\r\n    const url = new URL(s, baseURI);\r\n    return url.href;\r\n  } else {\r\n    return s;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @return {Vec2} Vec2.\r\n */\r\nfunction readVec2(node) {\r\n  const xunits = node.getAttribute('xunits');\r\n  const yunits = node.getAttribute('yunits');\r\n  let origin;\r\n  if (xunits !== 'insetPixels') {\r\n    if (yunits !== 'insetPixels') {\r\n      origin = IconOrigin.BOTTOM_LEFT;\r\n    } else {\r\n      origin = IconOrigin.TOP_LEFT;\r\n    }\r\n  } else {\r\n    if (yunits !== 'insetPixels') {\r\n      origin = IconOrigin.BOTTOM_RIGHT;\r\n    } else {\r\n      origin = IconOrigin.TOP_RIGHT;\r\n    }\r\n  }\r\n  return {\r\n    x: parseFloat(node.getAttribute('x')),\r\n    xunits: ICON_ANCHOR_UNITS_MAP[xunits],\r\n    y: parseFloat(node.getAttribute('y')),\r\n    yunits: ICON_ANCHOR_UNITS_MAP[yunits],\r\n    origin: origin\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @return {number|undefined} Scale.\r\n */\r\nfunction readScale(node) {\r\n  return readDecimal(node);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst STYLE_MAP_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Pair': pairDataParser\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Array<Style>|string|undefined} StyleMap.\r\n */\r\nfunction readStyleMapValue(node, objectStack) {\r\n  return pushParseAndPop(undefined,\r\n    STYLE_MAP_PARSERS, node, objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst ICON_STYLE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Icon': makeObjectPropertySetter(readIcon),\r\n    'heading': makeObjectPropertySetter(readDecimal),\r\n    'hotSpot': makeObjectPropertySetter(readVec2),\r\n    'scale': makeObjectPropertySetter(readScale)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction iconStyleParser(node, objectStack) {\r\n  // FIXME refreshMode\r\n  // FIXME refreshInterval\r\n  // FIXME viewRefreshTime\r\n  // FIXME viewBoundScale\r\n  // FIXME viewFormat\r\n  // FIXME httpQuery\r\n  const object = pushParseAndPop(\r\n    {}, ICON_STYLE_PARSERS, node, objectStack);\r\n  if (!object) {\r\n    return;\r\n  }\r\n  const styleObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\r\n  const IconObject = 'Icon' in object ? object['Icon'] : {};\r\n  const drawIcon = (!('Icon' in object) || Object.keys(IconObject).length > 0);\r\n  let src;\r\n  const href = /** @type {string|undefined} */\r\n    (IconObject['href']);\r\n  if (href) {\r\n    src = href;\r\n  } else if (drawIcon) {\r\n    src = DEFAULT_IMAGE_STYLE_SRC;\r\n  }\r\n  let anchor, anchorXUnits, anchorYUnits;\r\n  let anchorOrigin = IconOrigin.BOTTOM_LEFT;\r\n  const hotSpot = /** @type {Vec2|undefined} */\r\n    (object['hotSpot']);\r\n  if (hotSpot) {\r\n    anchor = [hotSpot.x, hotSpot.y];\r\n    anchorXUnits = hotSpot.xunits;\r\n    anchorYUnits = hotSpot.yunits;\r\n    anchorOrigin = hotSpot.origin;\r\n  } else if (src === DEFAULT_IMAGE_STYLE_SRC) {\r\n    anchor = DEFAULT_IMAGE_STYLE_ANCHOR;\r\n    anchorXUnits = DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\r\n    anchorYUnits = DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\r\n  } else if (/^http:\\/\\/maps\\.(?:google|gstatic)\\.com\\//.test(src)) {\r\n    anchor = [0.5, 0];\r\n    anchorXUnits = IconAnchorUnits.FRACTION;\r\n    anchorYUnits = IconAnchorUnits.FRACTION;\r\n  }\r\n\r\n  let offset;\r\n  const x = /** @type {number|undefined} */\r\n    (IconObject['x']);\r\n  const y = /** @type {number|undefined} */\r\n    (IconObject['y']);\r\n  if (x !== undefined && y !== undefined) {\r\n    offset = [x, y];\r\n  }\r\n\r\n  let size;\r\n  const w = /** @type {number|undefined} */\r\n    (IconObject['w']);\r\n  const h = /** @type {number|undefined} */\r\n    (IconObject['h']);\r\n  if (w !== undefined && h !== undefined) {\r\n    size = [w, h];\r\n  }\r\n\r\n  let rotation;\r\n  const heading = /** @type {number} */\r\n    (object['heading']);\r\n  if (heading !== undefined) {\r\n    rotation = toRadians(heading);\r\n  }\r\n\r\n  let scale = /** @type {number|undefined} */\r\n    (object['scale']);\r\n\r\n  if (drawIcon) {\r\n    if (src == DEFAULT_IMAGE_STYLE_SRC) {\r\n      size = DEFAULT_IMAGE_STYLE_SIZE;\r\n      if (scale === undefined) {\r\n        scale = DEFAULT_IMAGE_SCALE_MULTIPLIER;\r\n      }\r\n    }\r\n\r\n    const imageStyle = new Icon({\r\n      anchor: anchor,\r\n      anchorOrigin: anchorOrigin,\r\n      anchorXUnits: anchorXUnits,\r\n      anchorYUnits: anchorYUnits,\r\n      crossOrigin: 'anonymous', // FIXME should this be configurable?\r\n      offset: offset,\r\n      offsetOrigin: IconOrigin.BOTTOM_LEFT,\r\n      rotation: rotation,\r\n      scale: scale,\r\n      size: size,\r\n      src: src\r\n    });\r\n    styleObject['imageStyle'] = imageStyle;\r\n  } else {\r\n    // handle the case when we explicitly want to draw no icon.\r\n    styleObject['imageStyle'] = DEFAULT_NO_IMAGE_STYLE;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst LABEL_STYLE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'color': makeObjectPropertySetter(readColor),\r\n    'scale': makeObjectPropertySetter(readScale)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction labelStyleParser(node, objectStack) {\r\n  // FIXME colorMode\r\n  const object = pushParseAndPop(\r\n    {}, LABEL_STYLE_PARSERS, node, objectStack);\r\n  if (!object) {\r\n    return;\r\n  }\r\n  const styleObject = objectStack[objectStack.length - 1];\r\n  const textStyle = new Text({\r\n    fill: new Fill({\r\n\r\n      color: /** @type {import(\"../color.js\").Color} */\r\n        ('color' in object ? object['color'] : DEFAULT_COLOR)\r\n    }),\r\n    scale: /** @type {number|undefined} */\r\n      (object['scale'])\r\n  });\r\n  styleObject['textStyle'] = textStyle;\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst LINE_STYLE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'color': makeObjectPropertySetter(readColor),\r\n    'width': makeObjectPropertySetter(readDecimal),\r\n    'lineDash': makeObjectPropertySetter(readString) //FIXME Read from se:LineSymbolizer http://www.opengis.net/se\r\n\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction lineStyleParser(node, objectStack) {\r\n  // FIXME colorMode\r\n  // FIXME gx:outerColor\r\n  // FIXME gx:outerWidth\r\n  // FIXME gx:physicalWidth\r\n  // FIXME gx:labelVisibility\r\n  const object = pushParseAndPop(\r\n    {}, LINE_STYLE_PARSERS, node, objectStack);\r\n  if (!object) {\r\n    return;\r\n  }\r\n\r\n  const styleObject = objectStack[objectStack.length - 1];\r\n  const strokeStyle = new Stroke({\r\n    color: /** @type {import(\"../color.js\").Color} */\r\n      ('color' in object ? object['color'] : DEFAULT_COLOR),\r\n    width: /** @type {number} */ ('width' in object ? object['width'] : 1)\r\n    , lineDash: ('lineDash' in object ? object['lineDash'].toString().split(',') : [])\r\n  });\r\n\r\n  styleObject['strokeStyle'] = strokeStyle;\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst POLY_STYLE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'color': makeObjectPropertySetter(readColor),\r\n    'fill': makeObjectPropertySetter(readBoolean),\r\n    'outline': makeObjectPropertySetter(readBoolean)\r\n    , 'LineSymbolizer': LineSymbolizerParser\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction polyStyleParser(node, objectStack) {\r\n  // FIXME colorMode\r\n\r\n  const object = pushParseAndPop(\r\n    {}, POLY_STYLE_PARSERS, node, objectStack);\r\n  if (!object) {\r\n    return;\r\n  }\r\n  const styleObject = objectStack[objectStack.length - 1];\r\n\r\n  const fillStyle = new Fill({\r\n    color: /** @type {import(\"../color.js\").Color} */\r\n      ('color' in object ? object['color'] : DEFAULT_COLOR)\r\n  });\r\n  styleObject['fillStyle'] = fillStyle;\r\n  const fill = /** @type {boolean|undefined} */ (object['fill']);\r\n  if (fill !== undefined) {\r\n    styleObject['fill'] = fill;\r\n  }\r\n  styleObject['foo'] = { bar: 'Yes!' };\r\n  const outline = /** @type {boolean|undefined} */ (object['outline']);\r\n  if (outline !== undefined) {\r\n    styleObject['outline'] = outline;\r\n  }\r\n  //styleObject['strokeStyle'].setLineDash([5, 8]); //TODO LineDAsh\r\n  // console.log('Текущий стиль', styleObject);\r\n}\r\n\r\nconst LS_STYLE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Stroke': strokeParse\r\n  });\r\n\r\nfunction LineSymbolizerParser(node, objectStack) {\r\n\r\n  const object = pushParseAndPop(\r\n    {}, LS_STYLE_PARSERS, node, objectStack);\r\n  const styleObject = objectStack[objectStack.length - 1];\r\n  console.log('Парсим символизатор', styleObject);\r\n}\r\n\r\nconst LSTROKE_STYLE_PARSERS = makeStructureNS(\r\n  ['http://www.opengis.net/se'], {\r\n    'SvgParameter': makeObjectPropertySetter(readString),\r\n  });\r\n\r\nfunction strokeParse(node, objectStack) {\r\n  const object = pushParseAndPop(\r\n    {}, LSTROKE_STYLE_PARSERS, node, objectStack);\r\n  const styleObject = objectStack[objectStack.length - 1];\r\n  // styleObject['outline'] = outline;\r\n  //objectStack.foo = 'Bar';\r\n\r\n  console.log('Парсим далее', styleObject);\r\n}\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst FLAT_LINEAR_RING_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'coordinates': makeReplacer(readFlatCoordinates)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Array<number>} LinearRing flat coordinates.\r\n */\r\nfunction readFlatLinearRing(node, objectStack) {\r\n  return pushParseAndPop(null,\r\n    FLAT_LINEAR_RING_PARSERS, node, objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction gxCoordParser(node, objectStack) {\r\n  const gxTrackObject = /** @type {GxTrackObject} */\r\n    (objectStack[objectStack.length - 1]);\r\n  const flatCoordinates = gxTrackObject.flatCoordinates;\r\n  const s = getAllTextContent(node, false);\r\n  const re =\r\n    /^\\s*([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s*$/i;\r\n  const m = re.exec(s);\r\n  if (m) {\r\n    const x = parseFloat(m[1]);\r\n    const y = parseFloat(m[2]);\r\n    const z = parseFloat(m[3]);\r\n    flatCoordinates.push(x, y, z, 0);\r\n  } else {\r\n    flatCoordinates.push(0, 0, 0, 0);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst GX_MULTITRACK_GEOMETRY_PARSERS = makeStructureNS(\r\n  GX_NAMESPACE_URIS, {\r\n    'Track': makeArrayPusher(readGxTrack)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {MultiLineString|undefined} MultiLineString.\r\n */\r\nfunction readGxMultiTrack(node, objectStack) {\r\n  const lineStrings = pushParseAndPop([],\r\n    GX_MULTITRACK_GEOMETRY_PARSERS, node, objectStack);\r\n  if (!lineStrings) {\r\n    return undefined;\r\n  }\r\n  return new MultiLineString(lineStrings);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst GX_TRACK_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'when': whenParser\r\n  }, makeStructureNS(\r\n    GX_NAMESPACE_URIS, {\r\n      'coord': gxCoordParser\r\n    }));\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {LineString|undefined} LineString.\r\n */\r\nfunction readGxTrack(node, objectStack) {\r\n  const gxTrackObject = pushParseAndPop(\r\n    /** @type {GxTrackObject} */({\r\n      flatCoordinates: [],\r\n      whens: []\r\n    }), GX_TRACK_PARSERS, node, objectStack);\r\n  if (!gxTrackObject) {\r\n    return undefined;\r\n  }\r\n  const flatCoordinates = gxTrackObject.flatCoordinates;\r\n  const whens = gxTrackObject.whens;\r\n  for (let i = 0, ii = Math.min(flatCoordinates.length, whens.length); i < ii; ++i) {\r\n    flatCoordinates[4 * i + 3] = whens[i];\r\n  }\r\n  return new LineString(flatCoordinates, GeometryLayout.XYZM);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst ICON_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'href': makeObjectPropertySetter(readURI)\r\n  }, makeStructureNS(\r\n    GX_NAMESPACE_URIS, {\r\n      'x': makeObjectPropertySetter(readDecimal),\r\n      'y': makeObjectPropertySetter(readDecimal),\r\n      'w': makeObjectPropertySetter(readDecimal),\r\n      'h': makeObjectPropertySetter(readDecimal)\r\n    }));\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Object} Icon object.\r\n */\r\nfunction readIcon(node, objectStack) {\r\n  const iconObject = pushParseAndPop(\r\n    {}, ICON_PARSERS, node, objectStack);\r\n  if (iconObject) {\r\n    return iconObject;\r\n  } else {\r\n    return null;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst GEOMETRY_FLAT_COORDINATES_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'coordinates': makeReplacer(readFlatCoordinates)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Array<number>} Flat coordinates.\r\n */\r\nfunction readFlatCoordinatesFromNode(node, objectStack) {\r\n  return pushParseAndPop(null,\r\n    GEOMETRY_FLAT_COORDINATES_PARSERS, node, objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst EXTRUDE_AND_ALTITUDE_MODE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'extrude': makeObjectPropertySetter(readBoolean),\r\n    'tessellate': makeObjectPropertySetter(readBoolean),\r\n    'altitudeMode': makeObjectPropertySetter(readString)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {LineString|undefined} LineString.\r\n */\r\nfunction readLineString(node, objectStack) {\r\n  const properties = pushParseAndPop({},\r\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\r\n    objectStack);\r\n  const flatCoordinates =\r\n    readFlatCoordinatesFromNode(node, objectStack);\r\n  if (flatCoordinates) {\r\n    const lineString = new LineString(flatCoordinates, GeometryLayout.XYZ);\r\n    lineString.setProperties(properties);\r\n    return lineString;\r\n  } else {\r\n    return undefined;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Polygon|undefined} Polygon.\r\n */\r\nfunction readLinearRing(node, objectStack) {\r\n  const properties = pushParseAndPop({},\r\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\r\n    objectStack);\r\n  const flatCoordinates =\r\n    readFlatCoordinatesFromNode(node, objectStack);\r\n  if (flatCoordinates) {\r\n    const polygon = new Polygon(flatCoordinates, GeometryLayout.XYZ, [flatCoordinates.length]);\r\n    polygon.setProperties(properties);\r\n    return polygon;\r\n  } else {\r\n    return undefined;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst MULTI_GEOMETRY_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'LineString': makeArrayPusher(readLineString),\r\n    'LinearRing': makeArrayPusher(readLinearRing),\r\n    'MultiGeometry': makeArrayPusher(readMultiGeometry),\r\n    'Point': makeArrayPusher(readPoint),\r\n    'Polygon': makeArrayPusher(readPolygon)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {import(\"../geom/Geometry.js\").default} Geometry.\r\n */\r\nfunction readMultiGeometry(node, objectStack) {\r\n  const geometries = pushParseAndPop([],\r\n    MULTI_GEOMETRY_PARSERS, node, objectStack);\r\n  if (!geometries) {\r\n    return null;\r\n  }\r\n  if (geometries.length === 0) {\r\n    return new GeometryCollection(geometries);\r\n  }\r\n  let multiGeometry;\r\n  let homogeneous = true;\r\n  const type = geometries[0].getType();\r\n  let geometry;\r\n  for (let i = 1, ii = geometries.length; i < ii; ++i) {\r\n    geometry = geometries[i];\r\n    if (geometry.getType() != type) {\r\n      homogeneous = false;\r\n      break;\r\n    }\r\n  }\r\n  if (homogeneous) {\r\n    let layout;\r\n    let flatCoordinates;\r\n    if (type == GeometryType.POINT) {\r\n      const point = geometries[0];\r\n      layout = point.getLayout();\r\n      flatCoordinates = point.getFlatCoordinates();\r\n      for (let i = 1, ii = geometries.length; i < ii; ++i) {\r\n        geometry = geometries[i];\r\n        extend(flatCoordinates, geometry.getFlatCoordinates());\r\n      }\r\n      multiGeometry = new MultiPoint(flatCoordinates, layout);\r\n      setCommonGeometryProperties(multiGeometry, geometries);\r\n    } else if (type == GeometryType.LINE_STRING) {\r\n      multiGeometry = new MultiLineString(geometries);\r\n      setCommonGeometryProperties(multiGeometry, geometries);\r\n    } else if (type == GeometryType.POLYGON) {\r\n      multiGeometry = new MultiPolygon(geometries);\r\n      setCommonGeometryProperties(multiGeometry, geometries);\r\n    } else if (type == GeometryType.GEOMETRY_COLLECTION) {\r\n      multiGeometry = new GeometryCollection(geometries);\r\n    } else {\r\n      assert(false, 37); // Unknown geometry type found\r\n    }\r\n  } else {\r\n    multiGeometry = new GeometryCollection(geometries);\r\n  }\r\n  return (\r\n    /** @type {import(\"../geom/Geometry.js\").default} */ (multiGeometry)\r\n  );\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Point|undefined} Point.\r\n */\r\nfunction readPoint(node, objectStack) {\r\n  const properties = pushParseAndPop({},\r\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\r\n    objectStack);\r\n  const flatCoordinates =\r\n    readFlatCoordinatesFromNode(node, objectStack);\r\n  if (flatCoordinates) {\r\n    const point = new Point(flatCoordinates, GeometryLayout.XYZ);\r\n    point.setProperties(properties);\r\n    return point;\r\n  } else {\r\n    return undefined;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst FLAT_LINEAR_RINGS_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'innerBoundaryIs': innerBoundaryIsParser,\r\n    'outerBoundaryIs': outerBoundaryIsParser\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Polygon|undefined} Polygon.\r\n */\r\nfunction readPolygon(node, objectStack) {\r\n  const properties = pushParseAndPop(/** @type {Object<string,*>} */({}),\r\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\r\n    objectStack);\r\n  const flatLinearRings = pushParseAndPop([null],\r\n    FLAT_LINEAR_RINGS_PARSERS, node, objectStack);\r\n  if (flatLinearRings && flatLinearRings[0]) {\r\n    const flatCoordinates = flatLinearRings[0];\r\n    const ends = [flatCoordinates.length];\r\n    for (let i = 1, ii = flatLinearRings.length; i < ii; ++i) {\r\n      extend(flatCoordinates, flatLinearRings[i]);\r\n      ends.push(flatCoordinates.length);\r\n    }\r\n    const polygon = new Polygon(flatCoordinates, GeometryLayout.XYZ, ends);\r\n    polygon.setProperties(properties);\r\n    return polygon;\r\n  } else {\r\n    return undefined;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst STYLE_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'IconStyle': iconStyleParser,\r\n    'LabelStyle': labelStyleParser,\r\n    'LineStyle': lineStyleParser,\r\n    'PolyStyle': polyStyleParser\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @return {Array<Style>} Style.\r\n */\r\nfunction readStyle(node, objectStack) {\r\n\r\n  const styleObject = pushParseAndPop(\r\n    {}, STYLE_PARSERS, node, objectStack);\r\n  if (!styleObject) {\r\n    return null;\r\n  }\r\n  let fillStyle = /** @type {Fill} */\r\n    ('fillStyle' in styleObject ?\r\n      styleObject['fillStyle'] : DEFAULT_FILL_STYLE);\r\n  const fill = /** @type {boolean|undefined} */ (styleObject['fill']);\r\n  if (fill !== undefined && !fill) {\r\n    fillStyle = null;\r\n  }\r\n  let imageStyle;\r\n  if ('imageStyle' in styleObject) {\r\n    if (styleObject['imageStyle'] != DEFAULT_NO_IMAGE_STYLE) {\r\n      imageStyle = styleObject['imageStyle'];\r\n    }\r\n  } else {\r\n    imageStyle = DEFAULT_IMAGE_STYLE;\r\n  }\r\n  const textStyle = /** @type {Text} */\r\n    ('textStyle' in styleObject ?\r\n      styleObject['textStyle'] : DEFAULT_TEXT_STYLE);\r\n  let strokeStyle = /** @type {Stroke} */\r\n    ('strokeStyle' in styleObject ?\r\n      styleObject['strokeStyle'] : DEFAULT_STROKE_STYLE);\r\n  const outline = /** @type {boolean|undefined} */\r\n    (styleObject['outline']);\r\n  if (outline !== undefined && !outline) {\r\n    strokeStyle = null;\r\n  }\r\n  return [new Style({\r\n    fill: fillStyle,\r\n    image: imageStyle,\r\n    stroke: strokeStyle,\r\n    text: textStyle,\r\n    zIndex: undefined // FIXME\r\n  })];\r\n}\r\n\r\n\r\n/**\r\n * Reads an array of geometries and creates arrays for common geometry\r\n * properties. Then sets them to the multi geometry.\r\n * @param {MultiPoint|MultiLineString|MultiPolygon} multiGeometry A multi-geometry.\r\n * @param {Array<import(\"../geom/Geometry.js\").default>} geometries List of geometries.\r\n */\r\nfunction setCommonGeometryProperties(multiGeometry, geometries) {\r\n  const ii = geometries.length;\r\n  const extrudes = new Array(geometries.length);\r\n  const tessellates = new Array(geometries.length);\r\n  const altitudeModes = new Array(geometries.length);\r\n  let hasExtrude, hasTessellate, hasAltitudeMode;\r\n  hasExtrude = hasTessellate = hasAltitudeMode = false;\r\n  for (let i = 0; i < ii; ++i) {\r\n    const geometry = geometries[i];\r\n    extrudes[i] = geometry.get('extrude');\r\n    tessellates[i] = geometry.get('tessellate');\r\n    altitudeModes[i] = geometry.get('altitudeMode');\r\n    hasExtrude = hasExtrude || extrudes[i] !== undefined;\r\n    hasTessellate = hasTessellate || tessellates[i] !== undefined;\r\n    hasAltitudeMode = hasAltitudeMode || altitudeModes[i];\r\n  }\r\n  if (hasExtrude) {\r\n    multiGeometry.set('extrude', extrudes);\r\n  }\r\n  if (hasTessellate) {\r\n    multiGeometry.set('tessellate', tessellates);\r\n  }\r\n  if (hasAltitudeMode) {\r\n    multiGeometry.set('altitudeMode', altitudeModes);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst DATA_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'displayName': makeObjectPropertySetter(readString),\r\n    'value': makeObjectPropertySetter(readString)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction dataParser(node, objectStack) {\r\n  const name = node.getAttribute('name');\r\n  parseNode(DATA_PARSERS, node, objectStack);\r\n  const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\r\n  if (name !== null) {\r\n    featureObject[name] = featureObject.value;\r\n  } else if (featureObject.displayName !== null) {\r\n    featureObject[featureObject.displayName] = featureObject.value;\r\n  }\r\n  delete featureObject['value'];\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst EXTENDED_DATA_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Data': dataParser,\r\n    'SchemaData': schemaDataParser\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction extendedDataParser(node, objectStack) {\r\n  parseNode(EXTENDED_DATA_PARSERS, node, objectStack);\r\n}\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction regionParser(node, objectStack) {\r\n  parseNode(REGION_PARSERS, node, objectStack);\r\n}\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst PAIR_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Style': makeObjectPropertySetter(readStyle),\r\n    'key': makeObjectPropertySetter(readString),\r\n    'styleUrl': makeObjectPropertySetter(readURI)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction pairDataParser(node, objectStack) {\r\n  const pairObject = pushParseAndPop(\r\n    {}, PAIR_PARSERS, node, objectStack);\r\n  if (!pairObject) {\r\n    return;\r\n  }\r\n  const key = /** @type {string|undefined} */\r\n    (pairObject['key']);\r\n  if (key && key == 'normal') {\r\n    const styleUrl = /** @type {string|undefined} */\r\n      (pairObject['styleUrl']);\r\n    if (styleUrl) {\r\n      objectStack[objectStack.length - 1] = styleUrl;\r\n    }\r\n    const style = /** @type {Style} */\r\n      (pairObject['Style']);\r\n    if (style) {\r\n      objectStack[objectStack.length - 1] = style;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction placemarkStyleMapParser(node, objectStack) {\r\n  const styleMapValue = readStyleMapValue(node, objectStack);\r\n  if (!styleMapValue) {\r\n    return;\r\n  }\r\n  const placemarkObject = objectStack[objectStack.length - 1];\r\n  if (Array.isArray(styleMapValue)) {\r\n    placemarkObject['Style'] = styleMapValue;\r\n  } else if (typeof styleMapValue === 'string') {\r\n    placemarkObject['styleUrl'] = styleMapValue;\r\n  } else {\r\n    assert(false, 38); // `styleMapValue` has an unknown type\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst SCHEMA_DATA_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'SimpleData': simpleDataParser\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction schemaDataParser(node, objectStack) {\r\n  parseNode(SCHEMA_DATA_PARSERS, node, objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction simpleDataParser(node, objectStack) {\r\n  const name = node.getAttribute('name');\r\n  if (name !== null) {\r\n    const data = readString(node);\r\n    const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\r\n    featureObject[name] = data;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst LAT_LON_ALT_BOX_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'altitudeMode': makeObjectPropertySetter(readString),\r\n    'minAltitude': makeObjectPropertySetter(readDecimal),\r\n    'maxAltitude': makeObjectPropertySetter(readDecimal),\r\n    'north': makeObjectPropertySetter(readDecimal),\r\n    'south': makeObjectPropertySetter(readDecimal),\r\n    'east': makeObjectPropertySetter(readDecimal),\r\n    'west': makeObjectPropertySetter(readDecimal)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction latLonAltBoxParser(node, objectStack) {\r\n  const object = pushParseAndPop({}, LAT_LON_ALT_BOX_PARSERS, node, objectStack);\r\n  if (!object) {\r\n    return;\r\n  }\r\n  const regionObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\r\n  const extent = [\r\n    parseFloat(object['west']),\r\n    parseFloat(object['south']),\r\n    parseFloat(object['east']),\r\n    parseFloat(object['north'])\r\n  ];\r\n  regionObject['extent'] = extent;\r\n  regionObject['altitudeMode'] = object['altitudeMode'];\r\n  regionObject['minAltitude'] = parseFloat(object['minAltitude']);\r\n  regionObject['maxAltitude'] = parseFloat(object['maxAltitude']);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst LOD_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'minLodPixels': makeObjectPropertySetter(readDecimal),\r\n    'maxLodPixels': makeObjectPropertySetter(readDecimal),\r\n    'minFadeExtent': makeObjectPropertySetter(readDecimal),\r\n    'maxFadeExtent': makeObjectPropertySetter(readDecimal)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction lodParser(node, objectStack) {\r\n  const object = pushParseAndPop({}, LOD_PARSERS, node, objectStack);\r\n  if (!object) {\r\n    return;\r\n  }\r\n  const lodObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\r\n  lodObject['minLodPixels'] = parseFloat(object['minLodPixels']);\r\n  lodObject['maxLodPixels'] = parseFloat(object['maxLodPixels']);\r\n  lodObject['minFadeExtent'] = parseFloat(object['minFadeExtent']);\r\n  lodObject['maxFadeExtent'] = parseFloat(object['maxFadeExtent']);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst INNER_BOUNDARY_IS_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'LinearRing': makeReplacer(readFlatLinearRing)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction innerBoundaryIsParser(node, objectStack) {\r\n  /** @type {Array<number>|undefined} */\r\n  const flatLinearRing = pushParseAndPop(undefined,\r\n    INNER_BOUNDARY_IS_PARSERS, node, objectStack);\r\n  if (flatLinearRing) {\r\n    const flatLinearRings = /** @type {Array<Array<number>>} */\r\n      (objectStack[objectStack.length - 1]);\r\n    flatLinearRings.push(flatLinearRing);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\r\n */\r\nconst OUTER_BOUNDARY_IS_PARSERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'LinearRing': makeReplacer(readFlatLinearRing)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction outerBoundaryIsParser(node, objectStack) {\r\n  /** @type {Array<number>|undefined} */\r\n  const flatLinearRing = pushParseAndPop(undefined,\r\n    OUTER_BOUNDARY_IS_PARSERS, node, objectStack);\r\n  if (flatLinearRing) {\r\n    const flatLinearRings = /** @type {Array<Array<number>>} */\r\n      (objectStack[objectStack.length - 1]);\r\n    flatLinearRings[0] = flatLinearRing;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction linkParser(node, objectStack) {\r\n  parseNode(LINK_PARSERS, node, objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction whenParser(node, objectStack) {\r\n  const gxTrackObject = /** @type {GxTrackObject} */\r\n    (objectStack[objectStack.length - 1]);\r\n  const whens = gxTrackObject.whens;\r\n  const s = getAllTextContent(node, false);\r\n  const when = Date.parse(s);\r\n  whens.push(isNaN(when) ? 0 : when);\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node to append a TextNode with the color to.\r\n * @param {import(\"../color.js\").Color|string} color Color.\r\n */\r\nfunction writeColorTextNode(node, color) {\r\n  const rgba = asArray(color);\r\n  const opacity = (rgba.length == 4) ? rgba[3] : 1;\r\n  /** @type {Array<string|number>} */\r\n  const abgr = [opacity * 255, rgba[2], rgba[1], rgba[0]];\r\n  for (let i = 0; i < 4; ++i) {\r\n    const hex = Math.floor(/** @type {number} */(abgr[i])).toString(16);\r\n    abgr[i] = (hex.length == 1) ? '0' + hex : hex;\r\n  }\r\n  writeStringTextNode(node, abgr.join(''));\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node to append a TextNode with the coordinates to.\r\n * @param {Array<number>} coordinates Coordinates.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeCoordinatesTextNode(node, coordinates, objectStack) {\r\n  const context = objectStack[objectStack.length - 1];\r\n\r\n  const layout = context['layout'];\r\n  const stride = context['stride'];\r\n\r\n  let dimension;\r\n  if (layout == GeometryLayout.XY ||\r\n    layout == GeometryLayout.XYM) {\r\n    dimension = 2;\r\n  } else if (layout == GeometryLayout.XYZ ||\r\n    layout == GeometryLayout.XYZM) {\r\n    dimension = 3;\r\n  } else {\r\n    assert(false, 34); // Invalid geometry layout\r\n  }\r\n\r\n  const ii = coordinates.length;\r\n  let text = '';\r\n  if (ii > 0) {\r\n    text += coordinates[0];\r\n    for (let d = 1; d < dimension; ++d) {\r\n      text += ',' + coordinates[d];\r\n    }\r\n    for (let i = stride; i < ii; i += stride) {\r\n      text += ' ' + coordinates[i];\r\n      for (let d = 1; d < dimension; ++d) {\r\n        text += ',' + coordinates[i + d];\r\n      }\r\n    }\r\n  }\r\n  writeStringTextNode(node, text);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst EXTENDEDDATA_NODE_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Data': makeChildAppender(writeDataNode),\r\n    'value': makeChildAppender(writeDataNodeValue),\r\n    'displayName': makeChildAppender(writeDataNodeName)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Element} node Node.\r\n * @param {{name: *, value: *}} pair Name value pair.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeDataNode(node, pair, objectStack) {\r\n  node.setAttribute('name', pair.name);\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const value = pair.value;\r\n\r\n  if (typeof value == 'object') {\r\n    if (value !== null && value.displayName) {\r\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\r\n        OBJECT_PROPERTY_NODE_FACTORY, [value.displayName], objectStack, ['displayName']);\r\n    }\r\n\r\n    if (value !== null && value.value) {\r\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\r\n        OBJECT_PROPERTY_NODE_FACTORY, [value.value], objectStack, ['value']);\r\n    }\r\n  } else {\r\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\r\n      OBJECT_PROPERTY_NODE_FACTORY, [value], objectStack, ['value']);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node to append a TextNode with the name to.\r\n * @param {string} name DisplayName.\r\n */\r\nfunction writeDataNodeName(node, name) {\r\n  writeCDATASection(node, name);\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node to append a CDATA Section with the value to.\r\n * @param {string} value Value.\r\n */\r\nfunction writeDataNodeValue(node, value) {\r\n  writeStringTextNode(node, value);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst DOCUMENT_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Placemark': makeChildAppender(writePlacemark)\r\n  });\r\n\r\n\r\n/**\r\n * @const\r\n * @param {*} value Value.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @param {string=} opt_nodeName Node name.\r\n * @return {Node|undefined} Node.\r\n */\r\nconst DOCUMENT_NODE_FACTORY = function (value, objectStack, opt_nodeName) {\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  return createElementNS(parentNode.namespaceURI, 'Placemark');\r\n};\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Array<Feature>} features Features.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @this {KML}\r\n */\r\nfunction writeDocument(node, features, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  pushSerializeAndPop(context, DOCUMENT_SERIALIZERS,\r\n    DOCUMENT_NODE_FACTORY, features, objectStack, undefined,\r\n    this);\r\n}\r\n\r\n\r\n/**\r\n * A factory for creating Data nodes.\r\n * @const\r\n * @type {function(*, Array<*>): (Node|undefined)}\r\n */\r\nconst DATA_NODE_FACTORY = makeSimpleNodeFactory('Data');\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {{names: Array<string>, values: (Array<*>)}} namesAndValues Names and values.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeExtendedData(node, namesAndValues, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const names = namesAndValues.names;\r\n  const values = namesAndValues.values;\r\n  const length = names.length;\r\n\r\n  for (let i = 0; i < length; i++) {\r\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\r\n      DATA_NODE_FACTORY, [{ name: names[i], value: values[i] }], objectStack);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst ICON_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'href'\r\n  ],\r\n  makeStructureNS(GX_NAMESPACE_URIS, [\r\n    'x', 'y', 'w', 'h'\r\n  ]));\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst ICON_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'href': makeChildAppender(writeStringTextNode)\r\n  }, makeStructureNS(\r\n    GX_NAMESPACE_URIS, {\r\n      'x': makeChildAppender(writeDecimalTextNode),\r\n      'y': makeChildAppender(writeDecimalTextNode),\r\n      'w': makeChildAppender(writeDecimalTextNode),\r\n      'h': makeChildAppender(writeDecimalTextNode)\r\n    }));\r\n\r\n\r\n/**\r\n * @const\r\n * @param {*} value Value.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @param {string=} opt_nodeName Node name.\r\n * @return {Node|undefined} Node.\r\n */\r\nconst GX_NODE_FACTORY = function (value, objectStack, opt_nodeName) {\r\n  return createElementNS(GX_NAMESPACE_URIS[0],\r\n    'gx:' + opt_nodeName);\r\n};\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Object} icon Icon object.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeIcon(node, icon, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  let orderedKeys = ICON_SEQUENCE[parentNode.namespaceURI];\r\n  let values = makeSequence(icon, orderedKeys);\r\n  pushSerializeAndPop(context,\r\n    ICON_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\r\n    values, objectStack, orderedKeys);\r\n  orderedKeys =\r\n    ICON_SEQUENCE[GX_NAMESPACE_URIS[0]];\r\n  values = makeSequence(icon, orderedKeys);\r\n  pushSerializeAndPop(context, ICON_SERIALIZERS,\r\n    GX_NODE_FACTORY, values, objectStack, orderedKeys);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst ICON_STYLE_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'scale', 'heading', 'Icon', 'hotSpot'\r\n  ]);\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst ICON_STYLE_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'Icon': makeChildAppender(writeIcon),\r\n    'heading': makeChildAppender(writeDecimalTextNode),\r\n    'hotSpot': makeChildAppender(writeVec2),\r\n    'scale': makeChildAppender(writeScaleTextNode)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {import(\"../style/Icon.js\").default} style Icon style.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeIconStyle(node, style, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const properties = {};\r\n  const src = style.getSrc();\r\n  const size = style.getSize();\r\n  const iconImageSize = style.getImageSize();\r\n  const iconProperties = {\r\n    'href': src\r\n  };\r\n\r\n  if (size) {\r\n    iconProperties['w'] = size[0];\r\n    iconProperties['h'] = size[1];\r\n    const anchor = style.getAnchor(); // top-left\r\n    const origin = style.getOrigin(); // top-left\r\n\r\n    if (origin && iconImageSize && origin[0] !== 0 && origin[1] !== size[1]) {\r\n      iconProperties['x'] = origin[0];\r\n      iconProperties['y'] = iconImageSize[1] - (origin[1] + size[1]);\r\n    }\r\n\r\n    if (anchor && (anchor[0] !== size[0] / 2 || anchor[1] !== size[1] / 2)) {\r\n      const /** @type {Vec2} */ hotSpot = {\r\n        x: anchor[0],\r\n        xunits: IconAnchorUnits.PIXELS,\r\n        y: size[1] - anchor[1],\r\n        yunits: IconAnchorUnits.PIXELS\r\n      };\r\n      properties['hotSpot'] = hotSpot;\r\n    }\r\n  }\r\n\r\n  properties['Icon'] = iconProperties;\r\n\r\n  const scale = style.getScale();\r\n  if (scale !== 1) {\r\n    properties['scale'] = scale;\r\n  }\r\n\r\n  const rotation = style.getRotation();\r\n  if (rotation !== 0) {\r\n    properties['heading'] = rotation; // 0-360\r\n  }\r\n\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  const orderedKeys = ICON_STYLE_SEQUENCE[parentNode.namespaceURI];\r\n  const values = makeSequence(properties, orderedKeys);\r\n  pushSerializeAndPop(context, ICON_STYLE_SERIALIZERS,\r\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst LABEL_STYLE_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'color', 'scale'\r\n  ]);\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst LABEL_STYLE_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'color': makeChildAppender(writeColorTextNode),\r\n    'scale': makeChildAppender(writeScaleTextNode)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Text} style style.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeLabelStyle(node, style, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const properties = {};\r\n  const fill = style.getFill();\r\n  if (fill) {\r\n    properties['color'] = fill.getColor();\r\n  }\r\n  const scale = style.getScale();\r\n  if (scale && scale !== 1) {\r\n    properties['scale'] = scale;\r\n  }\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  const orderedKeys =\r\n    LABEL_STYLE_SEQUENCE[parentNode.namespaceURI];\r\n  const values = makeSequence(properties, orderedKeys);\r\n  pushSerializeAndPop(context, LABEL_STYLE_SERIALIZERS,\r\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst LINE_STYLE_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'color', 'width'\r\n  ]);\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst LINE_STYLE_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'color': makeChildAppender(writeColorTextNode),\r\n    'width': makeChildAppender(writeDecimalTextNode)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Stroke} style style.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeLineStyle(node, style, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const properties = {\r\n    'color': style.getColor(),\r\n    'width': style.getWidth()\r\n  };\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  const orderedKeys = LINE_STYLE_SEQUENCE[parentNode.namespaceURI];\r\n  const values = makeSequence(properties, orderedKeys);\r\n  pushSerializeAndPop(context, LINE_STYLE_SERIALIZERS,\r\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, string>}\r\n */\r\nconst GEOMETRY_TYPE_TO_NODENAME = {\r\n  'Point': 'Point',\r\n  'LineString': 'LineString',\r\n  'LinearRing': 'LinearRing',\r\n  'Polygon': 'Polygon',\r\n  'MultiPoint': 'MultiGeometry',\r\n  'MultiLineString': 'MultiGeometry',\r\n  'MultiPolygon': 'MultiGeometry',\r\n  'GeometryCollection': 'MultiGeometry'\r\n};\r\n\r\n\r\n/**\r\n * @const\r\n * @param {*} value Value.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @param {string=} opt_nodeName Node name.\r\n * @return {Node|undefined} Node.\r\n */\r\nconst GEOMETRY_NODE_FACTORY = function (value, objectStack, opt_nodeName) {\r\n  if (value) {\r\n    const parentNode = objectStack[objectStack.length - 1].node;\r\n    return createElementNS(parentNode.namespaceURI,\r\n      GEOMETRY_TYPE_TO_NODENAME[/** @type {import(\"../geom/Geometry.js\").default} */ (value).getType()]);\r\n  }\r\n};\r\n\r\n\r\n/**\r\n * A factory for creating Point nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst POINT_NODE_FACTORY = makeSimpleNodeFactory('Point');\r\n\r\n\r\n/**\r\n * A factory for creating LineString nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst LINE_STRING_NODE_FACTORY = makeSimpleNodeFactory('LineString');\r\n\r\n\r\n/**\r\n * A factory for creating LinearRing nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst LINEAR_RING_NODE_FACTORY = makeSimpleNodeFactory('LinearRing');\r\n\r\n\r\n/**\r\n * A factory for creating Polygon nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst POLYGON_NODE_FACTORY = makeSimpleNodeFactory('Polygon');\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst MULTI_GEOMETRY_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'LineString': makeChildAppender(\r\n      writePrimitiveGeometry),\r\n    'Point': makeChildAppender(\r\n      writePrimitiveGeometry),\r\n    'Polygon': makeChildAppender(writePolygon),\r\n    'GeometryCollection': makeChildAppender(\r\n      writeMultiGeometry)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeMultiGeometry(node, geometry, objectStack) {\r\n  /** @type {import(\"../xml.js\").NodeStackItem} */\r\n  const context = { node: node };\r\n  const type = geometry.getType();\r\n  /** @type {Array<import(\"../geom/Geometry.js\").default>} */\r\n  let geometries;\r\n  /** @type {function(*, Array<*>, string=): (Node|undefined)} */\r\n  let factory;\r\n  if (type == GeometryType.GEOMETRY_COLLECTION) {\r\n    geometries = /** @type {GeometryCollection} */ (geometry).getGeometries();\r\n    factory = GEOMETRY_NODE_FACTORY;\r\n  } else if (type == GeometryType.MULTI_POINT) {\r\n    geometries = /** @type {MultiPoint} */ (geometry).getPoints();\r\n    factory = POINT_NODE_FACTORY;\r\n  } else if (type == GeometryType.MULTI_LINE_STRING) {\r\n    geometries =\r\n      (/** @type {MultiLineString} */ (geometry)).getLineStrings();\r\n    factory = LINE_STRING_NODE_FACTORY;\r\n  } else if (type == GeometryType.MULTI_POLYGON) {\r\n    geometries =\r\n      (/** @type {MultiPolygon} */ (geometry)).getPolygons();\r\n    factory = POLYGON_NODE_FACTORY;\r\n  } else {\r\n    assert(false, 39); // Unknown geometry type\r\n  }\r\n  pushSerializeAndPop(context,\r\n    MULTI_GEOMETRY_SERIALIZERS, factory,\r\n    geometries, objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst BOUNDARY_IS_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'LinearRing': makeChildAppender(\r\n      writePrimitiveGeometry)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {import(\"../geom/LinearRing.js\").default} linearRing Linear ring.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeBoundaryIs(node, linearRing, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  pushSerializeAndPop(context,\r\n    BOUNDARY_IS_SERIALIZERS,\r\n    LINEAR_RING_NODE_FACTORY, [linearRing], objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst PLACEMARK_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'ExtendedData': makeChildAppender(writeExtendedData),\r\n    'MultiGeometry': makeChildAppender(writeMultiGeometry),\r\n    'LineString': makeChildAppender(writePrimitiveGeometry),\r\n    'LinearRing': makeChildAppender(writePrimitiveGeometry),\r\n    'Point': makeChildAppender(writePrimitiveGeometry),\r\n    'Polygon': makeChildAppender(writePolygon),\r\n    'Style': makeChildAppender(writeStyle),\r\n    'address': makeChildAppender(writeStringTextNode),\r\n    'description': makeChildAppender(writeStringTextNode),\r\n    'name': makeChildAppender(writeStringTextNode),\r\n    'open': makeChildAppender(writeBooleanTextNode),\r\n    'phoneNumber': makeChildAppender(writeStringTextNode),\r\n    'styleUrl': makeChildAppender(writeStringTextNode),\r\n    'visibility': makeChildAppender(writeBooleanTextNode)\r\n  });\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst PLACEMARK_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'name', 'open', 'visibility', 'address', 'phoneNumber', 'description',\r\n    'styleUrl', 'Style'\r\n  ]);\r\n\r\n\r\n/**\r\n * A factory for creating ExtendedData nodes.\r\n * @const\r\n * @type {function(*, Array<*>): (Node|undefined)}\r\n */\r\nconst EXTENDEDDATA_NODE_FACTORY = makeSimpleNodeFactory('ExtendedData');\r\n\r\n\r\n/**\r\n * FIXME currently we do serialize arbitrary/custom feature properties\r\n * (ExtendedData).\r\n * @param {Element} node Node.\r\n * @param {Feature} feature Feature.\r\n * @param {Array<*>} objectStack Object stack.\r\n * @this {KML}\r\n */\r\nfunction writePlacemark(node, feature, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n\r\n  // set id\r\n  if (feature.getId()) {\r\n    node.setAttribute('id', /** @type {string} */(feature.getId()));\r\n  }\r\n\r\n  // serialize properties (properties unknown to KML are not serialized)\r\n  const properties = feature.getProperties();\r\n\r\n  // don't export these to ExtendedData\r\n  const filter = {\r\n    'address': 1, 'description': 1, 'name': 1, 'open': 1,\r\n    'phoneNumber': 1, 'styleUrl': 1, 'visibility': 1\r\n  };\r\n  filter[feature.getGeometryName()] = 1;\r\n  const keys = Object.keys(properties || {}).sort().filter(function (v) {\r\n    return !filter[v];\r\n  });\r\n\r\n  if (keys.length > 0) {\r\n    const sequence = makeSequence(properties, keys);\r\n    const namesAndValues = { names: keys, values: sequence };\r\n    pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\r\n      EXTENDEDDATA_NODE_FACTORY, [namesAndValues], objectStack);\r\n  }\r\n\r\n  const styleFunction = feature.getStyleFunction();\r\n  if (styleFunction) {\r\n    // FIXME the styles returned by the style function are supposed to be\r\n    // resolution-independent here\r\n    const styles = styleFunction(feature, 0);\r\n    if (styles) {\r\n      const style = Array.isArray(styles) ? styles[0] : styles;\r\n      if (this.writeStyles_) {\r\n        properties['Style'] = style;\r\n      }\r\n      const textStyle = style.getText();\r\n      if (textStyle) {\r\n        properties['name'] = textStyle.getText();\r\n      }\r\n    }\r\n  }\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  const orderedKeys = PLACEMARK_SEQUENCE[parentNode.namespaceURI];\r\n  const values = makeSequence(properties, orderedKeys);\r\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\r\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\r\n\r\n  // serialize geometry\r\n  const options = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[0]);\r\n  let geometry = feature.getGeometry();\r\n  if (geometry) {\r\n    geometry = /** @type {import(\"../geom/Geometry.js\").default} */ (transformWithOptions(geometry, true, options));\r\n  }\r\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\r\n    GEOMETRY_NODE_FACTORY, [geometry], objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst PRIMITIVE_GEOMETRY_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'extrude', 'tessellate', 'altitudeMode', 'coordinates'\r\n  ]);\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst PRIMITIVE_GEOMETRY_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'extrude': makeChildAppender(writeBooleanTextNode),\r\n    'tessellate': makeChildAppender(writeBooleanTextNode),\r\n    'altitudeMode': makeChildAppender(writeStringTextNode),\r\n    'coordinates': makeChildAppender(writeCoordinatesTextNode)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writePrimitiveGeometry(node, geometry, objectStack) {\r\n  const flatCoordinates = geometry.getFlatCoordinates();\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  context['layout'] = geometry.getLayout();\r\n  context['stride'] = geometry.getStride();\r\n\r\n  // serialize properties (properties unknown to KML are not serialized)\r\n  const properties = geometry.getProperties();\r\n  properties.coordinates = flatCoordinates;\r\n\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  const orderedKeys = PRIMITIVE_GEOMETRY_SEQUENCE[parentNode.namespaceURI];\r\n  const values = makeSequence(properties, orderedKeys);\r\n  pushSerializeAndPop(context, PRIMITIVE_GEOMETRY_SERIALIZERS,\r\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst POLYGON_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'outerBoundaryIs': makeChildAppender(\r\n      writeBoundaryIs),\r\n    'innerBoundaryIs': makeChildAppender(\r\n      writeBoundaryIs)\r\n  });\r\n\r\n\r\n/**\r\n * A factory for creating innerBoundaryIs nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst INNER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('innerBoundaryIs');\r\n\r\n\r\n/**\r\n * A factory for creating outerBoundaryIs nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst OUTER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('outerBoundaryIs');\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Polygon} polygon Polygon.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writePolygon(node, polygon, objectStack) {\r\n  const linearRings = polygon.getLinearRings();\r\n  const outerRing = linearRings.shift();\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  // inner rings\r\n  pushSerializeAndPop(context,\r\n    POLYGON_SERIALIZERS,\r\n    INNER_BOUNDARY_NODE_FACTORY,\r\n    linearRings, objectStack);\r\n  // outer ring\r\n  pushSerializeAndPop(context,\r\n    POLYGON_SERIALIZERS,\r\n    OUTER_BOUNDARY_NODE_FACTORY,\r\n    [outerRing], objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst POLY_STYLE_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'color': makeChildAppender(writeColorTextNode)\r\n  });\r\n\r\n\r\n/**\r\n * A factory for creating coordinates nodes.\r\n * @const\r\n * @type {function(*, Array<*>, string=): (Node|undefined)}\r\n */\r\nconst COLOR_NODE_FACTORY = makeSimpleNodeFactory('color');\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Fill} style Style.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writePolyStyle(node, style, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  pushSerializeAndPop(context, POLY_STYLE_SERIALIZERS,\r\n    COLOR_NODE_FACTORY, [style.getColor()], objectStack);\r\n}\r\n\r\n\r\n/**\r\n * @param {Node} node Node to append a TextNode with the scale to.\r\n * @param {number|undefined} scale Scale.\r\n */\r\nfunction writeScaleTextNode(node, scale) {\r\n  // the Math is to remove any excess decimals created by float arithmetic\r\n  writeDecimalTextNode(node,\r\n    Math.round(scale * 1e6) / 1e6);\r\n}\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Array<string>>}\r\n */\r\nconst STYLE_SEQUENCE = makeStructureNS(\r\n  NAMESPACE_URIS, [\r\n    'IconStyle', 'LabelStyle', 'LineStyle', 'PolyStyle'\r\n  ]);\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\r\n */\r\nconst STYLE_SERIALIZERS = makeStructureNS(\r\n  NAMESPACE_URIS, {\r\n    'IconStyle': makeChildAppender(writeIconStyle),\r\n    'LabelStyle': makeChildAppender(writeLabelStyle),\r\n    'LineStyle': makeChildAppender(writeLineStyle),\r\n    'PolyStyle': makeChildAppender(writePolyStyle)\r\n  });\r\n\r\n\r\n/**\r\n * @param {Node} node Node.\r\n * @param {Style} style Style.\r\n * @param {Array<*>} objectStack Object stack.\r\n */\r\nfunction writeStyle(node, style, objectStack) {\r\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = { node: node };\r\n  const properties = {};\r\n  const fillStyle = style.getFill();\r\n  const strokeStyle = style.getStroke();\r\n  const imageStyle = style.getImage();\r\n  const textStyle = style.getText();\r\n  if (imageStyle && typeof /** @type {?} */ (imageStyle).getSrc === 'function') {\r\n    properties['IconStyle'] = imageStyle;\r\n  }\r\n  if (textStyle) {\r\n    properties['LabelStyle'] = textStyle;\r\n  }\r\n  if (strokeStyle) {\r\n    properties['LineStyle'] = strokeStyle;\r\n  }\r\n  if (fillStyle) {\r\n    properties['PolyStyle'] = fillStyle;\r\n  }\r\n  const parentNode = objectStack[objectStack.length - 1].node;\r\n  const orderedKeys = STYLE_SEQUENCE[parentNode.namespaceURI];\r\n  const values = makeSequence(properties, orderedKeys);\r\n  pushSerializeAndPop(context, STYLE_SERIALIZERS,\r\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\r\n}\r\n\r\n\r\n/**\r\n * @param {Element} node Node to append a TextNode with the Vec2 to.\r\n * @param {Vec2} vec2 Vec2.\r\n */\r\nfunction writeVec2(node, vec2) {\r\n  node.setAttribute('x', String(vec2.x));\r\n  node.setAttribute('y', String(vec2.y));\r\n  node.setAttribute('xunits', vec2.xunits);\r\n  node.setAttribute('yunits', vec2.yunits);\r\n}\r\n\r\n\r\nexport default KML;\r\n"],"names":["const","let","super","n","geometry","i","ii","d"],"mappings":"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"}